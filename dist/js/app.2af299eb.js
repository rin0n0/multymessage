(function(){"use strict";var t={4872:function(t,e,s){var a=s(5130),n=s(2261),r=s(6768);function c(t,e,s,a,n,c){const o=(0,r.g2)("Header"),i=(0,r.g2)("Main");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.bF)(o),(0,r.bF)(i)],64)}var o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAABaCAYAAAA4qEECAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFgklEQVR4nO2dXWgdRRSAv8R4b7Q/YFHrP63vxZ+iNaZJEfG3KIKtpkRs/SX1/wcfBPFNo1ITJCjtk0+CL2rR2lRtyIOoFUsErY/qg1VvrGlrNY2lJisDp3AJd2Z3c3dnZvfOBwfCDdk5c2bu2TNnzkwgEAgEAoFAIBAIBAKJOR1YAzwMjAC7gO+ASeAwEAEn5Ocf5XcfAK8C9wOrgdOSN9daXAQ8AYwCf4sxm5EjwE7gceACWpwq0A98DsxlYFyd/CcD2C9ttgxLgOeBP3I0rk5+BZ4BFlFy3/skMOXAwPPlkOjSQclYC/zggYHny7dAFyWgExgCZlMaYAb4EhgG+oBrgAuBs+S5Ffn5UolQNgMviS/+J2Vbc6KjemYhWQlMpOjwYeAtmf3KzSwU9bfdwDbgtxTtfw2soGBcVxfzRjEyBtyZU0Sg4ulbgL0pBruXgqC+6v8m6NR+4AaLein380lCt3UHnnNvAn9ck8Foc6TjBuCXBLH3FjzlblHQ1IHdwHJPYvl3Ehjbu5ndG+MuTgBPO5zFOh4UV2FyI974bBVi/WlQdhq4EX/pkdyI6QXpPBpRkcI3BiX/ko74zqqYUHBfkyFn0wwZlDsKXEVxWBUzs193pViXIcJQn6+nePQYfPashIhWUcmYA4bRf4Hi8pChXxO2NxW2GpR538PoIi2m0E9tJlhhkWwr6d7Q51B8lhgWNSqPfqYNJTYaRvsRysNGQz+fsqHAZov+6wxgh6Q+VbL+NcvbUZ9p+nrQhh7LG2yg5vVG3qFZxlctRla6Wb3JVhr0J2lwUjY+s6bNsCNu09hjBh2soAyxDGjPsY1jhhlly9i3ato/CZxHSRg2GNqWsdWa4XdN+49SEqpiTNfGHjKsGUpD1QNj92jancrZdbacsSuG3fUrKRlVx8bW7Td6u+XV7Mz6MMbYe6SeJGsGNe2pz0tJxZGxt7TCC9EHN9JlKCvLDJWtelN2TaICye4MZ/ZKTRtqhZwZ2z0wWrRAUfmSLDhb83yV7MoEFSce98Bg0QJlOqNYt6p5viqzyIRgaEuGLrrr2F4U13EqAT8Ssx3vo4wW7WVYxPBuNONY+lob4Z1PVBwtWO7TtPUeJaTicAn+iqa9l2nR1WBnTu1/2gpJpapjI1ckHm/U7hWUhKpjIyM10qVO/Fc9MLJp77I0L8IRD4zcIeduGrWvahALX27QbvCLtoyMlB/ryg1yP49zPfBzXdHfPTkZesaDAppxjQ4fl6kk7G3HRu42fKPUEb7SFDkuFmPPyOAOWy5yHHNZ5GgqZ82rcqcN+/QZ+qmuoLBSiF4zFKKfS/FZKpeoNOpjzVYhumLAMNo7S3C04l0H31ptbPm9QZkXKS4DMRcFWL+BbI3h7LeKQm6jeKyLOf52tSvFthlG/6gMRlG4LKacQh3rcEZFbm7RKXdMZkkRjKyrgVbyhesjyqf20g4ZlJwGbsZf1sXMZHWhwCV4wtoE10g862E0MhBzjcRx6ZtX3JXgYpQ9nlyMsjQmhIukL7fjKf0JjF2To2OuZnefYTFSn5lTqQav2RDzdYzqciM3WdSr25C7mO8uvJ3JjbZ+TLfSRHUyLm6nM6eF1XpDqrPRi887nxzHipjbaaJ5ckQqP3ubvFWxIs8YNuRkdCGcN9FFWjplUTObosORRDBfAW+I31dVQhfLNZntYsxlcp9TlxS3DEpJgGlXppHMymLEeZyclX88kNIANmS/y2V1XnQAj8UsbmzJpGThSn1F/WLguZT+Mys5KEl7a/lkH6hITDu+AB+eRk7KRmpfq10934jzxa3sirnRIKlMSXHLVk9Wot768tXAAxJ1fCQ1yDXZKpuT3MmU/HuQCTHqoBQcXl6WMq1AIBAIBAKBQCAQwAb/A2oFBSWHMrmlAAAAAElFTkSuQmCC",i=s.p+"img/gemini.c576e400.png",h=s.p+"img/gpt.4b8aa97a.png";function u(t,e){return(0,r.uX)(),(0,r.CE)("nav",null,e[0]||(e[0]=[(0,r.Fv)('<h1 data-v-5c8f1de8>Multy Message</h1><a target="_blank" href="https://docs.google.com/forms/d/e/1FAIpQLSc5Hgu1mmSEZyBxy1se6L3bdigLnaKNsV5ktR0QstKNtmAj7g/viewform?usp=header" data-v-5c8f1de8>обратная связь</a><div class="login" data-v-5c8f1de8><p data-v-5c8f1de8>Вход</p><img src="'+o+'" alt="log" id="log" data-v-5c8f1de8><img src="'+i+'" alt="gpt" data-v-5c8f1de8><img src="'+h+'" alt="gemeni" data-v-5c8f1de8></div>',3)]))}var l=s(1241);const d={},g=(0,l.A)(d,[["render",u],["__scopeId","data-v-5c8f1de8"]]);var p=g,f=s(144),m=s(4232);s(4114),s(8111),s(2489),s(116),s(531),s(1701);const A="https://nexra.aryahcr.cc/api/chat/gptweb",v="https://nexra.aryahcr.cc/api/chat/task";async function I(t){for(let s=0;s<30;s++){await new Promise((t=>setTimeout(t,500)));try{const e=await fetch(`${v}/${encodeURIComponent(t)}`);if(!e.ok){console.error(`Ошибка проверки задачи: Статус ${e.status}`);continue}const s=await e.json();if(console.log("Статус задачи:",s),"completed"===s.status)return s;if("error"===s.status)throw new Error(s.error||"Ошибка обработки задачи на сервере")}catch(e){if(console.error("Критическая ошибка при проверке задачи:",e),29===s)throw e}}throw new Error("Превышено время ожидания ответа от API")}const b=(0,n.nY)("store",{state:()=>({chats:[],tokenGemeni:"",tokenGpt:"","currentСhatId":""}),persist:!0,getters:{"currentСhat":t=>t.chats.find((e=>e.chatId===t.currentСhatId)),"currentСhatMessages"(){const t=this.currentСhat;return t?t.messages:void 0}},actions:{_getNextChatId(){if(0===this.chats.length)return 1;const t=Math.max(...this.chats.map((t=>t.chatId)));return t+1},_getNextMessageId(){const t=this.chats.flatMap((t=>t.messages));if(0===t.length)return 1;const e=Math.max(...t.map((t=>t.msgId)));return e+1},changeChat(t){this.currentСhatId=t},newMessage(t){if(!t||!this.currentСhatMessages)return;const e=this._getNextMessageId();this.currentСhatMessages.push({msgId:e,text:t,sender:"user"}),"gpt"===this.currentСhat?.model&&this.getGptResponse()},async getGptResponse(){if(!this.currentСhatMessages)return;const t=this._getNextMessageId(),e={msgId:t,text:"печатает...",sender:"gpt",isTyping:!0};this.currentСhatMessages.push(e);const s="не используй markdown!"+this.currentСhatMessages.filter((t=>!t.isTyping)).map((t=>`${t.sender}: ${t.text}`)).join("\n");console.log("Отправка промпта в API:",s);try{const t=await fetch(A,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:s,markdown:!1})});if(!t.ok)throw new Error(`Ошибка API: ${t.statusText}`);const a=await t.json();if(!a.id)throw new Error("API не вернул ID задачи");const n=await I(a.id);if(!n?.gpt)throw new Error("Пустой ответ от API");{const t=this.currentСhatMessages.findIndex((t=>t.msgId===e.msgId));-1!==t&&(this.currentСhatMessages[t]={msgId:e.msgId,text:n.gpt,sender:"gpt"})}}catch(a){console.error("Ошибка при получении ответа от GPT:",a);const t=this.currentСhatMessages.findIndex((t=>t.msgId===e.msgId));-1!==t&&(this.currentСhatMessages[t]={msgId:e.msgId,text:`Ошибка: ${a.message}`,sender:"gpt",isError:!0})}},newChat(t){const e=this._getNextChatId(),s=this._getNextMessageId();this.chats.push({chatId:e,messages:[{msgId:s,text:"Проси, что хочешь!",sender:t}],model:t,date:k()}),this.currentСhatId=e},deleteChat(t){this.chats=this.chats.filter((e=>e.chatId!==t)),this.currentСhatId===t&&(this.currentСhatId=this.chats.length>0?this.chats[0].chatId:"")}}});function k(){const t=new Date,e=String(t.getDate()).padStart(2,"0"),s=String(t.getMonth()+1).padStart(2,"0");return`${e}.${s}`}const C={class:"chatlist"},y={key:0},_=["onClick"],w={class:"chatlist__chat__meta"},M={class:"chatlist__chat__meta__top"},E={class:"chatlist__chat__meta__bottom"},x=["onClick"],R={class:"chatlist__add"};var F={__name:"ChatsList",setup(t){const e=b(),{chats:s}=(0,n.bP)(e),{changeChat:a,newChat:c,deleteChat:o}=e;return(t,e)=>((0,r.uX)(),(0,r.CE)("div",C,[(0,f.R1)(s)?((0,r.uX)(),(0,r.CE)("div",y,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)((0,f.R1)(s),(t=>((0,r.uX)(),(0,r.CE)("div",{class:(0,m.C4)(["chatlist__chat",t.model]),onClick:e=>(0,f.R1)(a)(t.chatId),key:t.id},[e[2]||(e[2]=(0,r.Lk)("div",{class:"chatlist__chat__left"},[(0,r.Lk)("div",{class:"chatlist__chat__img"})],-1)),(0,r.Lk)("div",w,[(0,r.Lk)("div",M,[(0,r.Lk)("h1",null,"Чат #"+(0,m.v_)(t.chatId),1),(0,r.Lk)("p",null,(0,m.v_)(t.date),1)]),(0,r.Lk)("div",E,[(0,r.Lk)("span",null,(0,m.v_)(t.messages.at(-1).text),1),(0,r.Lk)("button",{onClick:e=>(0,f.R1)(o)(t.chatId)},"✕",8,x)])])],10,_)))),128))])):(0,r.Q3)("",!0),(0,r.Lk)("div",R,[(0,r.Lk)("button",{onClick:e[0]||(e[0]=t=>(0,f.R1)(c)("gpt"))},"Gpt"),(0,r.Lk)("button",{onClick:e[1]||(e[1]=t=>(0,f.R1)(c)("gemini"))},"Gemini")])]))}};const L=(0,l.A)(F,[["__scopeId","data-v-73afba96"]]);var j=L;const N={class:"chat__messages"};var X={__name:"MessagesList",setup(t){const e=b(),{"currentСhatMessages":s}=(0,n.bP)(e);return(t,e)=>((0,r.uX)(),(0,r.CE)("div",N,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)((0,f.R1)(s),(t=>((0,r.uX)(),(0,r.CE)("div",{class:(0,m.C4)(["chat__message",t.sender]),key:t.msgId},[(0,r.Lk)("p",null,(0,m.v_)(t.text),1)],2)))),128))]))}};const B=(0,l.A)(X,[["__scopeId","data-v-00a1ab5e"]]);var S=B,O={__name:"MessageForm",props:{modelValue:{type:String},modelModifiers:{}},emits:["update:modelValue"],setup(t){const e=(0,r.fn)(t,"modelValue"),s=b(),{chats:c}=(0,n.bP)(s),{newMessage:o}=s;function i(){o(e.value.trim()),e.value=""}return(t,s)=>(0,f.R1)(c)[0]?((0,r.uX)(),(0,r.CE)("form",{key:0,onSubmit:(0,a.D$)(i,["prevent"])},[(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=t=>e.value=t),placeholder:"Введите сообщение..."},null,512),[[a.Jo,e.value]]),s[1]||(s[1]=(0,r.Lk)("button",{type:"submit"},null,-1))],32)):(0,r.Q3)("",!0)}};const Q=(0,l.A)(O,[["__scopeId","data-v-3a788bf7"]]);var P=Q;const T={class:"chat"};var Z={__name:"ChatBlock",setup(t){return(t,e)=>((0,r.uX)(),(0,r.CE)("div",T,[(0,r.bF)(S),(0,r.bF)(P)]))}};const G=(0,l.A)(Z,[["__scopeId","data-v-5cff7ddb"]]);var K=G,W={__name:"appMain",setup(t){return(t,e)=>((0,r.uX)(),(0,r.CE)("main",null,[(0,r.bF)(j),(0,r.bF)(K)]))}};const Y=(0,l.A)(W,[["__scopeId","data-v-23030c18"]]);var H=Y,J={name:"App",components:{Header:p,Main:H}};const q=(0,l.A)(J,[["render",c]]);var V=q,U=s(5827);const z=(0,a.Ef)(V),D=(0,n.Ey)();D.use(U.A),z.use(D),z.mount("#app")}},e={};function s(a){var n=e[a];if(void 0!==n)return n.exports;var r=e[a]={exports:{}};return t[a].call(r.exports,r,r.exports,s),r.exports}s.m=t,function(){var t=[];s.O=function(e,a,n,r){if(!a){var c=1/0;for(u=0;u<t.length;u++){a=t[u][0],n=t[u][1],r=t[u][2];for(var o=!0,i=0;i<a.length;i++)(!1&r||c>=r)&&Object.keys(s.O).every((function(t){return s.O[t](a[i])}))?a.splice(i--,1):(o=!1,r<c&&(c=r));if(o){t.splice(u--,1);var h=n();void 0!==h&&(e=h)}}return e}r=r||0;for(var u=t.length;u>0&&t[u-1][2]>r;u--)t[u]=t[u-1];t[u]=[a,n,r]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var a in e)s.o(e,a)&&!s.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){s.p="/"}(),function(){var t={524:0};s.O.j=function(e){return 0===t[e]};var e=function(e,a){var n,r,c=a[0],o=a[1],i=a[2],h=0;if(c.some((function(e){return 0!==t[e]}))){for(n in o)s.o(o,n)&&(s.m[n]=o[n]);if(i)var u=i(s)}for(e&&e(a);h<c.length;h++)r=c[h],s.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return s.O(u)},a=self["webpackChunkmultymessage"]=self["webpackChunkmultymessage"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=s.O(void 0,[504],(function(){return s(4872)}));a=s.O(a)})();
//# sourceMappingURL=app.2af299eb.js.map